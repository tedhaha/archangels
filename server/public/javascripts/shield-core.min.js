/* Shield Core 1.3.2 Trial Version | Copyright 2013 Shield UI Ltd. | www.shieldui.com/eula */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){function e(h){var i,d=h||window.event,l=[].slice.call(arguments,1),e=0,f=0,g=0,j=0,k=0;return h=a.event.fix(d),h.type="mousewheel",d.wheelDelta&&(e=d.wheelDelta),d.detail&&(e=-1*d.detail),d.deltaY&&(g=-1*d.deltaY,e=g),d.deltaX&&(f=d.deltaX,e=-1*f),void 0!==d.wheelDeltaY&&(g=d.wheelDeltaY),void 0!==d.wheelDeltaX&&(f=-1*d.wheelDeltaX),j=Math.abs(e),(!c||c>j)&&(c=j),k=Math.max(Math.abs(g),Math.abs(f)),(!b||b>k)&&(b=k),i=e>0?"floor":"ceil",e=Math[i](e/c),f=Math[i](f/b),g=Math[i](g/b),l.unshift(h,e,f,g),(a.event.dispatch||a.event.handle).apply(this,l)}var c,b,f=["wheel","mousewheel","DOMMouseScroll"],d="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"];if(a.event.fixHooks)for(var g=f.length;g;)a.event.fixHooks[f[--g]]=a.event.mouseHooks;a.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var a=d.length;a;)this.addEventListener(d[--a],e,!1);else this.onmousewheel=e},teardown:function(){if(this.removeEventListener)for(var a=d.length;a;)this.removeEventListener(d[--a],e,!1);else this.onmousewheel=null}},a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})});
function a(b){this.ok=!1,"#"==b.charAt(0)&&(b=b.substr(1,6)),b=b.replace(/ /g,""),b=b.toLowerCase();var e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var f in e)b==f&&(b=e[f]);for(var c=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],d=0;d<c.length;d++){var h=c[d].re,i=c[d].process,g=h.exec(b);g&&(channels=i(g),this.r=channels[0],this.g=channels[1],this.b=channels[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var a=this.r.toString(16),b=this.g.toString(16),c=this.b.toString(16);return 1==a.length&&(a="0"+a),1==b.length&&(b="0"+b),1==c.length&&(c="0"+c),"#"+a+b+c},this.getHelpXML=function(){for(var b=new Array,d=0;d<c.length;d++)for(var k=c[d].example,g=0;g<k.length;g++)b[b.length]=k[g];for(var l in e)b[b.length]=l;var h=document.createElement("ul");h.setAttribute("id","rgbcolor-examples");for(var d=0;d<b.length;d++)try{var j=document.createElement("li"),f=new a(b[d]),i=document.createElement("div");i.style.cssText="margin: 3px; border: 1px solid black; background:"+f.toHex()+"; "+"color:"+f.toHex(),i.appendChild(document.createTextNode("test"));var m=document.createTextNode(" "+b[d]+" -> "+f.toRGB()+" -> "+f.toHex());j.appendChild(i),j.appendChild(m),h.appendChild(j)}catch(n){}return h}}!function(){function b(){var b={};return b.FRAMERATE=30,b.MAX_VIRTUAL_PIXELS=3e4,b.init=function(a){b.Definitions={},b.Styles={},b.Animations=[],b.Images=[],b.ctx=a,b.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(a,b){this.viewPorts.push({width:a,height:b})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(a){return null!=a&&"number"==typeof a?a:"x"==a?this.width():"y"==a?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},b.init(),b.ImagesLoaded=function(){for(var a=0;a<b.Images.length;a++)if(!b.Images[a].loaded)return!1;return!0},b.trim=function(a){return a.replace(/^\s+|\s+$/g,"")},b.compressSpaces=function(a){return a.replace(/[\s\r\t\n]+/gm," ")},b.ajax=function(b){var a;return a=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),a?(a.open("GET",b,!1),a.send(null),a.responseText):null},b.parseXml=function(a){if(window.DOMParser){var c=new DOMParser;return c.parseFromString(a,"text/xml")}a=a.replace(/<!DOCTYPE svg[^>]*>/,"");var b=new ActiveXObject("Microsoft.XMLDOM");return b.async="false",b.loadXML(a),b},b.Property=function(a,b){this.name=a,this.value=b},b.Property.prototype.getValue=function(){return this.value},b.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},b.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var a=parseFloat(this.value);return(this.value+"").match(/%$/)&&(a/=100),a},b.Property.prototype.valueOrDefault=function(a){return this.hasValue()?this.value:a},b.Property.prototype.numValueOrDefault=function(a){return this.hasValue()?this.numValue():a},b.Property.prototype.addOpacity=function(d){var e=this.value;if(null!=d&&""!=d&&"string"==typeof this.value){var c=new a(this.value);c.ok&&(e="rgba("+c.r+", "+c.g+", "+c.b+", "+d+")")}return new b.Property(this.name,e)},b.Property.prototype.getDefinition=function(){var a=this.value.match(/#([^\)']+)/);return a&&(a=a[1]),a||(a=this.value),b.Definitions[a]},b.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},b.Property.prototype.getFillStyleDefinition=function(c,d){var a=this.getDefinition();return null!=a&&a.createGradient?a.createGradient(b.ctx,c,d):null!=a&&a.createPattern?a.createPattern(b.ctx,c):null},b.Property.prototype.getDPI=function(){return 96},b.Property.prototype.getEM=function(d){var a=12,c=new b.Property("fontSize",b.Font.Parse(b.ctx.font).fontSize);return c.hasValue()&&(a=c.toPixels(d)),a},b.Property.prototype.getUnits=function(){var a=this.value+"";return a.replace(/[0-9\.\-]/g,"")},b.Property.prototype.toPixels=function(c,e){if(!this.hasValue())return 0;var a=this.value+"";if(a.match(/em$/))return this.numValue()*this.getEM(c);if(a.match(/ex$/))return this.numValue()*this.getEM(c)/2;if(a.match(/px$/))return this.numValue();if(a.match(/pt$/))return this.numValue()*this.getDPI(c)*(1/72);if(a.match(/pc$/))return 15*this.numValue();if(a.match(/cm$/))return this.numValue()*this.getDPI(c)/2.54;if(a.match(/mm$/))return this.numValue()*this.getDPI(c)/25.4;if(a.match(/in$/))return this.numValue()*this.getDPI(c);if(a.match(/%$/))return this.numValue()*b.ViewPort.ComputeSize(c);var d=this.numValue();return e&&1>d?d*b.ViewPort.ComputeSize(c):d},b.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var a=this.value+"";return a.match(/s$/)?1e3*this.numValue():a.match(/ms$/)?this.numValue():this.numValue()},b.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var a=this.value+"";return a.match(/deg$/)?this.numValue()*(Math.PI/180):a.match(/grad$/)?this.numValue()*(Math.PI/200):a.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)},b.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(d,e,f,g,h,c){var a=null!=c?this.Parse(c):this.CreateFont("","","","","",b.ctx.font);return{fontFamily:h||a.fontFamily,fontSize:g||a.fontSize,fontStyle:d||a.fontStyle,fontWeight:f||a.fontWeight,fontVariant:e||a.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var a=this;this.Parse=function(h){for(var f={},d=b.trim(b.compressSpaces(h||"")).split(" "),e={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},g="",c=0;c<d.length;c++)e.fontStyle||-1==a.Styles.indexOf(d[c])?e.fontVariant||-1==a.Variants.indexOf(d[c])?e.fontWeight||-1==a.Weights.indexOf(d[c])?e.fontSize?"inherit"!=d[c]&&(g+=d[c]):("inherit"!=d[c]&&(f.fontSize=d[c].split("/")[0]),e.fontStyle=e.fontVariant=e.fontWeight=e.fontSize=!0):("inherit"!=d[c]&&(f.fontWeight=d[c]),e.fontStyle=e.fontVariant=e.fontWeight=!0):("inherit"!=d[c]&&(f.fontVariant=d[c]),e.fontStyle=e.fontVariant=!0):("inherit"!=d[c]&&(f.fontStyle=d[c]),e.fontStyle=!0);return""!=g&&(f.fontFamily=g),f}},b.ToNumberArray=function(d){for(var a=b.trim(b.compressSpaces((d||"").replace(/,/g," "))).split(" "),c=0;c<a.length;c++)a[c]=parseFloat(a[c]);return a},b.Point=function(a,b){this.x=a,this.y=b},b.Point.prototype.angleTo=function(a){return Math.atan2(a.y-this.y,a.x-this.x)},b.Point.prototype.applyTransform=function(a){var b=this.x*a[0]+this.y*a[2]+a[4],c=this.x*a[1]+this.y*a[3]+a[5];this.x=b,this.y=c},b.CreatePoint=function(c){var a=b.ToNumberArray(c);return new b.Point(a[0],a[1])},b.CreatePath=function(e){for(var c=b.ToNumberArray(e),d=[],a=0;a<c.length;a+=2)d.push(new b.Point(c[a],c[a+1]));return d},b.BoundingBox=function(a,b,c,d){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(a,b){null!=a&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=a,this.x2=a),a<this.x1&&(this.x1=a),a>this.x2&&(this.x2=a)),null!=b&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=b,this.y2=b),b<this.y1&&(this.y1=b),b>this.y2&&(this.y2=b))},this.addX=function(a){this.addPoint(a,null)},this.addY=function(a){this.addPoint(null,a)},this.addBoundingBox=function(a){this.addPoint(a.x1,a.y1),this.addPoint(a.x2,a.y2)},this.addQuadraticCurve=function(a,b,g,h,c,d){var e=a+2/3*(g-a),f=b+2/3*(h-b),i=e+1/3*(c-a),j=f+1/3*(d-b);this.addBezierCurve(a,b,e,i,f,j,c,d)},this.addBezierCurve=function(u,n,t,s,r,q,p,o){var b=[u,n],h=[t,s],k=[r,q],j=[p,o];for(this.addPoint(b[0],b[1]),this.addPoint(j[0],j[1]),i=0;1>=i;i++){var a=function(a){return Math.pow(1-a,3)*b[i]+3*Math.pow(1-a,2)*a*h[i]+3*(1-a)*Math.pow(a,2)*k[i]+Math.pow(a,3)*j[i]},c=6*b[i]-12*h[i]+6*k[i],g=-3*b[i]+9*h[i]-9*k[i]+3*j[i],m=3*h[i]-3*b[i];if(0!=g){var l=Math.pow(c,2)-4*m*g;if(!(0>l)){var f=(-c+Math.sqrt(l))/(2*g);f>0&&1>f&&(0==i&&this.addX(a(f)),1==i&&this.addY(a(f)));var e=(-c-Math.sqrt(l))/(2*g);e>0&&1>e&&(0==i&&this.addX(a(e)),1==i&&this.addY(a(e)))}}else{if(0==c)continue;var d=-m/c;d>0&&1>d&&(0==i&&this.addX(a(d)),1==i&&this.addY(a(d)))}}},this.isPointInBox=function(a,b){return this.x1<=a&&a<=this.x2&&this.y1<=b&&b<=this.y2},this.addPoint(a,b),this.addPoint(c,d)},b.Transform=function(g){var c=this;this.Type={},this.Type.translate=function(a){this.p=b.CreatePoint(a),this.apply=function(a){a.translate(this.p.x||0,this.p.y||0)},this.applyToPoint=function(a){a.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(c){var a=b.ToNumberArray(c);this.angle=new b.Property("angle",a[0]),this.cx=a[1]||0,this.cy=a[2]||0,this.apply=function(a){a.translate(this.cx,this.cy),a.rotate(this.angle.toRadians()),a.translate(-this.cx,-this.cy)},this.applyToPoint=function(b){var a=this.angle.toRadians();b.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),b.applyTransform([Math.cos(a),Math.sin(a),-Math.sin(a),Math.cos(a),0,0]),b.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(a){this.p=b.CreatePoint(a),this.apply=function(a){a.scale(this.p.x||1,this.p.y||this.p.x||1)},this.applyToPoint=function(a){a.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(a){this.m=b.ToNumberArray(a),this.apply=function(a){a.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.applyToPoint=function(a){a.applyTransform(this.m)}},this.Type.SkewBase=function(a){this.base=c.Type.matrix,this.base(a),this.angle=new b.Property("angle",a)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(a){this.base=c.Type.SkewBase,this.base(a),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(a){this.base=c.Type.SkewBase,this.base(a),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(b){for(var a=0;a<this.transforms.length;a++)this.transforms[a].apply(b)},this.applyToPoint=function(b){for(var a=0;a<this.transforms.length;a++)this.transforms[a].applyToPoint(b)};for(var d=b.trim(b.compressSpaces(g)).replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),a=0;a<d.length;a++){var e=d[a].split("(")[0],h=d[a].split("(")[1].replace(")",""),f=new this.Type[e](h);f.type=e,this.transforms.push(f)}},b.AspectRatio=function(d,h,n,k,o,j,q,p,l,m){h=b.compressSpaces(h),h=h.replace(/^defer\s/,"");var i=h.split(" ")[0]||"xMidYMid",a=h.split(" ")[1]||"meet",g=n/k,f=o/j,c=Math.min(g,f),e=Math.max(g,f);"meet"==a&&(k*=c,j*=c),"slice"==a&&(k*=e,j*=e),l=new b.Property("refX",l),m=new b.Property("refY",m),l.hasValue()&&m.hasValue()?d.translate(-c*l.toPixels("x"),-c*m.toPixels("y")):(i.match(/^xMid/)&&("meet"==a&&c==f||"slice"==a&&e==f)&&d.translate(n/2-k/2,0),i.match(/YMid$/)&&("meet"==a&&c==g||"slice"==a&&e==g)&&d.translate(0,o/2-j/2),i.match(/^xMax/)&&("meet"==a&&c==f||"slice"==a&&e==f)&&d.translate(n-k,0),i.match(/YMax$/)&&("meet"==a&&c==g||"slice"==a&&e==g)&&d.translate(0,o-j)),"none"==i?d.scale(g,f):"meet"==a?d.scale(c,c):"slice"==a&&d.scale(e,e),d.translate(null==q?0:-q,null==p?0:-p)},b.Element={},b.EmptyProperty=new b.Property("EMPTY",""),b.Element.ElementBase=function(e){if(this.attributes={},this.styles={},this.children=[],this.attribute=function(c,d){var a=this.attributes[c];return null!=a?a:(1==d&&(a=new b.Property(c,""),this.attributes[c]=a),a||b.EmptyProperty)},this.style=function(a,g){var c=this.styles[a];if(null!=c)return c;var d=this.attribute(a);if(null!=d&&d.hasValue())return this.styles[a]=d,d;var f=this.parent;if(null!=f){var e=f.style(a);if(null!=e&&e.hasValue())return e}return 1==g&&(c=new b.Property(a,""),this.styles[a]=c),c||b.EmptyProperty},this.render=function(a){if("none"!=this.style("display").value&&"hidden"!=this.attribute("visibility").value){if(a.save(),this.attribute("mask").hasValue()){var b=this.attribute("mask").getDefinition();null!=b&&b.apply(a,this)}else if(this.style("filter").hasValue()){var c=this.style("filter").getDefinition();null!=c&&c.apply(a,this)}else this.setContext(a),this.renderChildren(a),this.clearContext(a);a.restore()}},this.setContext=function(){},this.clearContext=function(){},this.renderChildren=function(b){for(var a=0;a<this.children.length;a++)this.children[a].render(b)},this.addChild=function(c,d){var a=c;d&&(a=b.CreateElement(c)),a.parent=this,this.children.push(a)},null!=e&&1==e.nodeType){for(var c=0;c<e.childNodes.length;c++){var f=e.childNodes[c];1==f.nodeType&&this.addChild(f,!0),this.captureTextNodes&&3==f.nodeType&&this.addChild(new b.Element.tspan(f),!1)}for(var c=0;c<e.attributes.length;c++){var h=e.attributes[c];this.attributes[h.nodeName]=new b.Property(h.nodeName,h.nodeValue)}var a=b.Styles[e.nodeName];if(null!=a)for(var d in a)this.styles[d]=a[d];if(this.attribute("class").hasValue())for(var i=b.compressSpaces(this.attribute("class").value).split(" "),g=0;g<i.length;g++){if(a=b.Styles["."+i[g]],null!=a)for(var d in a)this.styles[d]=a[d];if(a=b.Styles[e.nodeName+"."+i[g]],null!=a)for(var d in a)this.styles[d]=a[d]}if(this.attribute("id").hasValue()){var a=b.Styles["#"+this.attribute("id").value];if(null!=a)for(var d in a)this.styles[d]=a[d]}if(this.attribute("style").hasValue())for(var a=this.attribute("style").value.split(";"),c=0;c<a.length;c++)if(""!=b.trim(a[c])){var j=a[c].split(":"),d=b.trim(j[0]),k=b.trim(j[1]);this.styles[d]=new b.Property(d,k)}this.attribute("id").hasValue()&&null==b.Definitions[this.attribute("id").value]&&(b.Definitions[this.attribute("id").value]=this)}},b.Element.RenderedElementBase=function(a){this.base=b.Element.ElementBase,this.base(a),this.setContext=function(a){if(this.style("fill").isUrlDefinition()){var e=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity"));null!=e&&(a.fillStyle=e)}else if(this.style("fill").hasValue()){var c=this.style("fill");"currentColor"==c.value&&(c.value=this.style("color").value),a.fillStyle="none"==c.value?"rgba(0,0,0,0)":c.value}if(this.style("fill-opacity").hasValue()){var c=new b.Property("fill",a.fillStyle);c=c.addOpacity(this.style("fill-opacity").value),a.fillStyle=c.value}if(this.style("stroke").isUrlDefinition()){var e=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity"));null!=e&&(a.strokeStyle=e)}else if(this.style("stroke").hasValue()){var d=this.style("stroke");"currentColor"==d.value&&(d.value=this.style("color").value),a.strokeStyle="none"==d.value?"rgba(0,0,0,0)":d.value}if(this.style("stroke-opacity").hasValue()){var d=new b.Property("stroke",a.strokeStyle);d=d.addOpacity(this.style("stroke-opacity").value),a.strokeStyle=d.value}if(this.style("stroke-width").hasValue()){var f=this.style("stroke-width").toPixels();a.lineWidth=0==f?.001:f}if(this.style("stroke-linecap").hasValue()&&(a.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(a.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(a.miterLimit=this.style("stroke-miterlimit").value),"undefined"!=typeof a.font&&(a.font=b.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString()),this.attribute("transform").hasValue()){var h=new b.Transform(this.attribute("transform").value);h.apply(a)}if(this.attribute("clip-path").hasValue()){var g=this.attribute("clip-path").getDefinition();null!=g&&g.apply(a)}this.style("opacity").hasValue()&&(a.globalAlpha=this.style("opacity").numValue())}},b.Element.RenderedElementBase.prototype=new b.Element.ElementBase,b.Element.PathElementBase=function(a){this.base=b.Element.RenderedElementBase,this.base(a),this.path=function(a){return null!=a&&a.beginPath(),new b.BoundingBox},this.renderChildren=function(c){this.path(c),b.Mouse.checkPath(this,c),""!=c.fillStyle&&c.fill(),""!=c.strokeStyle&&c.stroke();var a=this.getMarkers();if(null!=a){if(this.style("marker-start").isUrlDefinition()){var e=this.style("marker-start").getDefinition();e.render(c,a[0][0],a[0][1])}if(this.style("marker-mid").isUrlDefinition())for(var e=this.style("marker-mid").getDefinition(),d=1;d<a.length-1;d++)e.render(c,a[d][0],a[d][1]);if(this.style("marker-end").isUrlDefinition()){var e=this.style("marker-end").getDefinition();e.render(c,a[a.length-1][0],a[a.length-1][1])}}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},b.Element.PathElementBase.prototype=new b.Element.RenderedElementBase,b.Element.svg=function(a){this.base=b.Element.RenderedElementBase,this.base(a),this.baseClearContext=this.clearContext,this.clearContext=function(a){this.baseClearContext(a),b.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(a){a.strokeStyle="rgba(0,0,0,0)",a.lineCap="butt",a.lineJoin="miter",a.miterLimit=4,this.baseSetContext(a),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),a.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var c=b.ViewPort.width(),d=b.ViewPort.height();if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),"undefined"==typeof this.root){c=this.attribute("width").toPixels("x"),d=this.attribute("height").toPixels("y");var f=0,g=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(f=-this.attribute("refX").toPixels("x"),g=-this.attribute("refY").toPixels("y")),a.beginPath(),a.moveTo(f,g),a.lineTo(c,g),a.lineTo(c,d),a.lineTo(f,d),a.closePath(),a.clip()}if(b.ViewPort.SetCurrent(c,d),this.attribute("viewBox").hasValue()){var e=b.ToNumberArray(this.attribute("viewBox").value),h=e[0],i=e[1];c=e[2],d=e[3],b.AspectRatio(a,this.attribute("preserveAspectRatio").value,b.ViewPort.width(),c,b.ViewPort.height(),d,h,i,this.attribute("refX").value,this.attribute("refY").value),b.ViewPort.RemoveCurrent(),b.ViewPort.SetCurrent(e[2],e[3])}}},b.Element.svg.prototype=new b.Element.RenderedElementBase,b.Element.rect=function(a){this.base=b.Element.PathElementBase,this.base(a),this.path=function(d){var a=this.attribute("x").toPixels("x"),c=this.attribute("y").toPixels("y"),f=this.attribute("width").toPixels("x"),g=this.attribute("height").toPixels("y"),e=this.attribute("rx").toPixels("x"),h=this.attribute("ry").toPixels("y");return this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(h=e),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(e=h),e=Math.min(e,f/2),h=Math.min(h,g/2),null!=d&&(d.beginPath(),d.moveTo(a+e,c),d.lineTo(a+f-e,c),d.quadraticCurveTo(a+f,c,a+f,c+h),d.lineTo(a+f,c+g-h),d.quadraticCurveTo(a+f,c+g,a+f-e,c+g),d.lineTo(a+e,c+g),d.quadraticCurveTo(a,c+g,a,c+g-h),d.lineTo(a,c+h),d.quadraticCurveTo(a,c,a+e,c),d.closePath()),new b.BoundingBox(a,c,a+f,c+g)}},b.Element.rect.prototype=new b.Element.PathElementBase,b.Element.circle=function(a){this.base=b.Element.PathElementBase,this.base(a),this.path=function(c){var d=this.attribute("cx").toPixels("x"),e=this.attribute("cy").toPixels("y"),a=this.attribute("r").toPixels();return null!=c&&(c.beginPath(),c.arc(d,e,a,0,2*Math.PI,!0),c.closePath()),new b.BoundingBox(d-a,e-a,d+a,e+a)}},b.Element.circle.prototype=new b.Element.PathElementBase,b.Element.ellipse=function(a){this.base=b.Element.PathElementBase,this.base(a),this.path=function(f){var g=4*((Math.sqrt(2)-1)/3),e=this.attribute("rx").toPixels("x"),d=this.attribute("ry").toPixels("y"),a=this.attribute("cx").toPixels("x"),c=this.attribute("cy").toPixels("y");return null!=f&&(f.beginPath(),f.moveTo(a,c-d),f.bezierCurveTo(a+g*e,c-d,a+e,c-g*d,a+e,c),f.bezierCurveTo(a+e,c+g*d,a+g*e,c+d,a,c+d),f.bezierCurveTo(a-g*e,c+d,a-e,c+g*d,a-e,c),f.bezierCurveTo(a-e,c-g*d,a-g*e,c-d,a,c-d),f.closePath()),new b.BoundingBox(a-e,c-d,a+e,c+d)}},b.Element.ellipse.prototype=new b.Element.PathElementBase,b.Element.line=function(a){this.base=b.Element.PathElementBase,this.base(a),this.getPoints=function(){return[new b.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new b.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(c){var a=this.getPoints();return null!=c&&(c.beginPath(),c.moveTo(a[0].x,a[0].y),c.lineTo(a[1].x,a[1].y)),new b.BoundingBox(a[0].x,a[0].y,a[1].x,a[1].y)},this.getMarkers=function(){var a=this.getPoints(),b=a[0].angleTo(a[1]);return[[a[0],b],[a[1],b]]}},b.Element.line.prototype=new b.Element.PathElementBase,b.Element.polyline=function(a){this.base=b.Element.PathElementBase,this.base(a),this.points=b.CreatePath(this.attribute("points").value),this.path=function(c){var d=new b.BoundingBox(this.points[0].x,this.points[0].y);null!=c&&(c.beginPath(),c.moveTo(this.points[0].x,this.points[0].y));for(var a=1;a<this.points.length;a++)d.addPoint(this.points[a].x,this.points[a].y),null!=c&&c.lineTo(this.points[a].x,this.points[a].y);return d},this.getMarkers=function(){for(var a=[],b=0;b<this.points.length-1;b++)a.push([this.points[b],this.points[b].angleTo(this.points[b+1])]);return a.push([this.points[this.points.length-1],a[a.length-1][1]]),a}},b.Element.polyline.prototype=new b.Element.PathElementBase,b.Element.polygon=function(a){this.base=b.Element.polyline,this.base(a),this.basePath=this.path,this.path=function(a){var b=this.basePath(a);return null!=a&&(a.lineTo(this.points[0].x,this.points[0].y),a.closePath()),b}},b.Element.polygon.prototype=new b.Element.polyline,b.Element.path=function(c){this.base=b.Element.PathElementBase,this.base(c);var a=this.attribute("d").value;a=a.replace(/,/gm," "),a=a.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),a=a.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),a=a.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2"),a=a.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),a=a.replace(/([0-9])([+\-])/gm,"$1 $2"),a=a.replace(/(\.[0-9]*)(\.)/gm,"$1 $2"),a=a.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),a=b.compressSpaces(a),a=b.trim(a),this.PathParser=new function(a){this.tokens=a.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new b.Point(0,0),this.control=new b.Point(0,0),this.current=new b.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return this.isEnd()?!0:null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var a=new b.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(a)},this.getAsControlPoint=function(){var a=this.getPoint();return this.control=a,a},this.getAsCurrentPoint=function(){var a=this.getPoint();return this.current=a,a},this.getReflectedControlPoint=function(){if("c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase())return this.current;var a=new b.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y);return a},this.makeAbsolute=function(a){return this.isRelativeCommand()&&(a.x+=this.current.x,a.y+=this.current.y),a},this.addMarker=function(a,b,c){null!=c&&this.angles.length>0&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(c)),this.addMarkerAngle(a,null==b?null:b.angleTo(a))},this.addMarkerAngle=function(a,b){this.points.push(a),this.angles.push(b)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var a=0;a<this.angles.length;a++)if(null==this.angles[a])for(var b=a+1;b<this.angles.length;b++)if(null!=this.angles[b]){this.angles[a]=this.angles[b];break}return this.angles}}(a),this.path=function(c){var a=this.PathParser;a.reset();var k=new b.BoundingBox;for(null!=c&&c.beginPath();!a.isEnd();)switch(a.nextCommand(),a.command){case"M":case"m":var h=a.getAsCurrentPoint();for(a.addMarker(h),k.addPoint(h.x,h.y),null!=c&&c.moveTo(h.x,h.y),a.start=a.current;!a.isCommandOrEnd();){var h=a.getAsCurrentPoint();a.addMarker(h,a.start),k.addPoint(h.x,h.y),null!=c&&c.lineTo(h.x,h.y)}break;case"L":case"l":for(;!a.isCommandOrEnd();){var F=a.current,h=a.getAsCurrentPoint();a.addMarker(h,F),k.addPoint(h.x,h.y),null!=c&&c.lineTo(h.x,h.y)}break;case"H":case"h":for(;!a.isCommandOrEnd();){var r=new b.Point((a.isRelativeCommand()?a.current.x:0)+a.getScalar(),a.current.y);a.addMarker(r,a.current),a.current=r,k.addPoint(a.current.x,a.current.y),null!=c&&c.lineTo(a.current.x,a.current.y)}break;case"V":case"v":for(;!a.isCommandOrEnd();){var r=new b.Point(a.current.x,(a.isRelativeCommand()?a.current.y:0)+a.getScalar());a.addMarker(r,a.current),a.current=r,k.addPoint(a.current.x,a.current.y),null!=c&&c.lineTo(a.current.x,a.current.y)}break;case"C":case"c":for(;!a.isCommandOrEnd();){var j=a.current,n=a.getPoint(),e=a.getAsControlPoint(),d=a.getAsCurrentPoint();a.addMarker(d,e,n),k.addBezierCurve(j.x,j.y,n.x,n.y,e.x,e.y,d.x,d.y),null!=c&&c.bezierCurveTo(n.x,n.y,e.x,e.y,d.x,d.y)}break;case"S":case"s":for(;!a.isCommandOrEnd();){var j=a.current,n=a.getReflectedControlPoint(),e=a.getAsControlPoint(),d=a.getAsCurrentPoint();a.addMarker(d,e,n),k.addBezierCurve(j.x,j.y,n.x,n.y,e.x,e.y,d.x,d.y),null!=c&&c.bezierCurveTo(n.x,n.y,e.x,e.y,d.x,d.y)}break;case"Q":case"q":for(;!a.isCommandOrEnd();){var j=a.current,e=a.getAsControlPoint(),d=a.getAsCurrentPoint();a.addMarker(d,e,e),k.addQuadraticCurve(j.x,j.y,e.x,e.y,d.x,d.y),null!=c&&c.quadraticCurveTo(e.x,e.y,d.x,d.y)}break;case"T":case"t":for(;!a.isCommandOrEnd();){var j=a.current,e=a.getReflectedControlPoint();a.control=e;var d=a.getAsCurrentPoint();a.addMarker(d,e,e),k.addQuadraticCurve(j.x,j.y,e.x,e.y,d.x,d.y),null!=c&&c.quadraticCurveTo(e.x,e.y,d.x,d.y)}break;case"A":case"a":for(;!a.isCommandOrEnd();){var j=a.current,f=a.getScalar(),g=a.getScalar(),m=a.getScalar()*(Math.PI/180),E=a.getScalar(),v=a.getScalar(),d=a.getAsCurrentPoint(),i=new b.Point(Math.cos(m)*(j.x-d.x)/2+Math.sin(m)*(j.y-d.y)/2,-Math.sin(m)*(j.x-d.x)/2+Math.cos(m)*(j.y-d.y)/2),w=Math.pow(i.x,2)/Math.pow(f,2)+Math.pow(i.y,2)/Math.pow(g,2);w>1&&(f*=Math.sqrt(w),g*=Math.sqrt(w));var q=(E==v?-1:1)*Math.sqrt((Math.pow(f,2)*Math.pow(g,2)-Math.pow(f,2)*Math.pow(i.y,2)-Math.pow(g,2)*Math.pow(i.x,2))/(Math.pow(f,2)*Math.pow(i.y,2)+Math.pow(g,2)*Math.pow(i.x,2)));isNaN(q)&&(q=0);var l=new b.Point(q*f*i.y/g,q*-g*i.x/f),o=new b.Point((j.x+d.x)/2+Math.cos(m)*l.x-Math.sin(m)*l.y,(j.y+d.y)/2+Math.sin(m)*l.x+Math.cos(m)*l.y),B=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2))},t=function(a,b){return(a[0]*b[0]+a[1]*b[1])/(B(a)*B(b))},A=function(a,b){return(a[0]*b[1]<a[1]*b[0]?-1:1)*Math.acos(t(a,b))},y=A([1,0],[(i.x-l.x)/f,(i.y-l.y)/g]),z=[(i.x-l.x)/f,(i.y-l.y)/g],x=[(-i.x-l.x)/f,(-i.y-l.y)/g],s=A(z,x);t(z,x)<=-1&&(s=Math.PI),t(z,x)>=1&&(s=0);var u=1-v?1:-1,p=y+u*(s/2),G=new b.Point(o.x+f*Math.cos(p),o.y+g*Math.sin(p));if(a.addMarkerAngle(G,p-u*Math.PI/2),a.addMarkerAngle(d,p-u*Math.PI),k.addPoint(d.x,d.y),null!=c){var t=f>g?f:g,C=f>g?1:f/g,D=f>g?g/f:1;c.translate(o.x,o.y),c.rotate(m),c.scale(C,D),c.arc(0,0,t,y,y+s,1-v),c.scale(1/C,1/D),c.rotate(-m),c.translate(-o.x,-o.y)}}break;case"Z":case"z":null!=c&&c.closePath(),a.current=a.start}return k},this.getMarkers=function(){for(var b=this.PathParser.getMarkerPoints(),d=this.PathParser.getMarkerAngles(),c=[],a=0;a<b.length;a++)c.push([b[a],d[a]]);return c}},b.Element.path.prototype=new b.Element.PathElementBase,b.Element.pattern=function(a){this.base=b.Element.ElementBase,this.base(a),this.createPattern=function(i){var g=this.attribute("width").toPixels("x",!0),h=this.attribute("height").toPixels("y",!0),a=new b.Element.svg;a.attributes.viewBox=new b.Property("viewBox",this.attribute("viewBox").value),a.attributes.width=new b.Property("width",g+"px"),a.attributes.height=new b.Property("height",h+"px"),a.attributes.transform=new b.Property("transform",this.attribute("patternTransform").value),a.children=this.children;
var c=document.createElement("canvas");c.width=g,c.height=h;var d=c.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&d.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var e=-1;1>=e;e++)for(var f=-1;1>=f;f++)d.save(),d.translate(e*c.width,f*c.height),a.render(d),d.restore();var j=i.createPattern(c,"repeat");return j}},b.Element.pattern.prototype=new b.Element.ElementBase,b.Element.marker=function(a){this.base=b.Element.ElementBase,this.base(a),this.baseRender=this.render,this.render=function(a,d,e){a.translate(d.x,d.y),"auto"==this.attribute("orient").valueOrDefault("auto")&&a.rotate(e),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&a.scale(a.lineWidth,a.lineWidth),a.save();var c=new b.Element.svg;c.attributes.viewBox=new b.Property("viewBox",this.attribute("viewBox").value),c.attributes.refX=new b.Property("refX",this.attribute("refX").value),c.attributes.refY=new b.Property("refY",this.attribute("refY").value),c.attributes.width=new b.Property("width",this.attribute("markerWidth").value),c.attributes.height=new b.Property("height",this.attribute("markerHeight").value),c.attributes.fill=new b.Property("fill",this.attribute("fill").valueOrDefault("black")),c.attributes.stroke=new b.Property("stroke",this.attribute("stroke").valueOrDefault("none")),c.children=this.children,c.render(a),a.restore(),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&a.scale(1/a.lineWidth,1/a.lineWidth),"auto"==this.attribute("orient").valueOrDefault("auto")&&a.rotate(-e),a.translate(-d.x,-d.y)}},b.Element.marker.prototype=new b.Element.ElementBase,b.Element.defs=function(a){this.base=b.Element.ElementBase,this.base(a),this.render=function(){}},b.Element.defs.prototype=new b.Element.ElementBase,b.Element.GradientBase=function(d){this.base=b.Element.ElementBase,this.base(d),this.gradientUnits=this.attribute("gradientUnits").valueOrDefault("objectBoundingBox"),this.stops=[];for(var a=0;a<this.children.length;a++){var c=this.children[a];"stop"==c.type&&this.stops.push(c)}this.getGradient=function(){},this.createGradient=function(n,m,l){var a=this;this.attribute("xlink:href").hasValue()&&(a=this.attribute("xlink:href").getDefinition());var k=function(a){if(l.hasValue()){var c=new b.Property("color",a);return c.addOpacity(l.value).value}return a},g=this.getGradient(n,m);if(null==g)return k(a.stops[a.stops.length-1].color);for(var e=0;e<a.stops.length;e++)g.addColorStop(a.stops[e].offset,k(a.stops[e].color));if(this.attribute("gradientTransform").hasValue()){var h=b.ViewPort.viewPorts[0],d=new b.Element.rect;d.attributes.x=new b.Property("x",-b.MAX_VIRTUAL_PIXELS/3),d.attributes.y=new b.Property("y",-b.MAX_VIRTUAL_PIXELS/3),d.attributes.width=new b.Property("width",b.MAX_VIRTUAL_PIXELS),d.attributes.height=new b.Property("height",b.MAX_VIRTUAL_PIXELS);var j=new b.Element.g;j.attributes.transform=new b.Property("transform",this.attribute("gradientTransform").value),j.children=[d];var c=new b.Element.svg;c.attributes.x=new b.Property("x",0),c.attributes.y=new b.Property("y",0),c.attributes.width=new b.Property("width",h.width),c.attributes.height=new b.Property("height",h.height),c.children=[j];var f=document.createElement("canvas");f.width=h.width,f.height=h.height;var i=f.getContext("2d");return i.fillStyle=g,c.render(i),i.createPattern(f,"no-repeat")}return g}},b.Element.GradientBase.prototype=new b.Element.ElementBase,b.Element.linearGradient=function(a){this.base=b.Element.GradientBase,this.base(a),this.getGradient=function(f,g){var a=g.getBoundingBox();this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var b="objectBoundingBox"==this.gradientUnits?a.x()+a.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),c="objectBoundingBox"==this.gradientUnits?a.y()+a.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),d="objectBoundingBox"==this.gradientUnits?a.x()+a.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),e="objectBoundingBox"==this.gradientUnits?a.y()+a.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return b==d&&c==e?null:f.createLinearGradient(b,c,d,e)}},b.Element.linearGradient.prototype=new b.Element.GradientBase,b.Element.radialGradient=function(a){this.base=b.Element.GradientBase,this.base(a),this.getGradient=function(f,g){var a=g.getBoundingBox();this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var b="objectBoundingBox"==this.gradientUnits?a.x()+a.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),c="objectBoundingBox"==this.gradientUnits?a.y()+a.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),d=b,e=c;this.attribute("fx").hasValue()&&(d="objectBoundingBox"==this.gradientUnits?a.x()+a.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(e="objectBoundingBox"==this.gradientUnits?a.y()+a.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var h="objectBoundingBox"==this.gradientUnits?(a.width()+a.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return f.createRadialGradient(d,e,0,b,c,h)}},b.Element.radialGradient.prototype=new b.Element.GradientBase,b.Element.stop=function(c){this.base=b.Element.ElementBase,this.base(c),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),this.offset>1&&(this.offset=1);var a=this.style("stop-color");this.style("stop-opacity").hasValue()&&(a=a.addOpacity(this.style("stop-opacity").value)),this.color=a.value},b.Element.stop.prototype=new b.Element.ElementBase,b.Element.AnimateBase=function(a){this.base=b.Element.ElementBase,this.base(a),b.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var b=this.attribute("attributeType").value,a=this.attribute("attributeName").value;return"CSS"==b?this.parent.style(a,!0):this.parent.attribute(a,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(c){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"!=this.attribute("repeatCount").value&&"indefinite"!=this.attribute("repeatDur").value)return"remove"!=this.attribute("fill").valueOrDefault("remove")||this.removed?!1:(this.removed=!0,this.getProperty().value=this.initialValue,!0);this.duration=0}this.duration=this.duration+c;var b=!1;if(this.begin<this.duration){var a=this.calcValue();if(this.attribute("type").hasValue()){var d=this.attribute("type").value;a=d+"("+a+")"}this.getProperty().value=a,b=!0}return b},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var a={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var c=a.progress*(this.values.value.length-1),d=Math.floor(c),e=Math.ceil(c);a.from=new b.Property("from",parseFloat(this.values.value[d])),a.to=new b.Property("to",parseFloat(this.values.value[e])),a.progress=(c-d)/(e-d)}else a.from=this.from,a.to=this.to;return a}},b.Element.AnimateBase.prototype=new b.Element.ElementBase,b.Element.animate=function(a){this.base=b.Element.AnimateBase,this.base(a),this.calcValue=function(){var a=this.progress(),b=a.from.numValue()+(a.to.numValue()-a.from.numValue())*a.progress;return b+this.initialUnits}},b.Element.animate.prototype=new b.Element.AnimateBase,b.Element.animateColor=function(c){this.base=b.Element.AnimateBase,this.base(c),this.calcValue=function(){var c=this.progress(),b=new a(c.from.value),d=new a(c.to.value);if(b.ok&&d.ok){var e=b.r+(d.r-b.r)*c.progress,f=b.g+(d.g-b.g)*c.progress,g=b.b+(d.b-b.b)*c.progress;return"rgb("+parseInt(e,10)+","+parseInt(f,10)+","+parseInt(g,10)+")"}return this.attribute("from").value}},b.Element.animateColor.prototype=new b.Element.AnimateBase,b.Element.animateTransform=function(a){this.base=b.Element.AnimateBase,this.base(a),this.calcValue=function(){for(var c=this.progress(),d=b.ToNumberArray(c.from.value),f=b.ToNumberArray(c.to.value),e="",a=0;a<d.length;a++)e+=d[a]+(f[a]-d[a])*c.progress+" ";return e}},b.Element.animateTransform.prototype=new b.Element.animate,b.Element.font=function(d){this.base=b.Element.ElementBase,this.base(d),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var c=0;c<this.children.length;c++){var a=this.children[c];"font-face"==a.type?(this.fontFace=a,a.style("font-family").hasValue()&&(b.Definitions[a.style("font-family").value]=this)):"missing-glyph"==a.type?this.missingGlyph=a:"glyph"==a.type&&(""!=a.arabicForm?(this.isRTL=!0,this.isArabic=!0,"undefined"==typeof this.glyphs[a.unicode]&&(this.glyphs[a.unicode]=[]),this.glyphs[a.unicode][a.arabicForm]=a):this.glyphs[a.unicode]=a)}},b.Element.font.prototype=new b.Element.ElementBase,b.Element.fontface=function(a){this.base=b.Element.ElementBase,this.base(a),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},b.Element.fontface.prototype=new b.Element.ElementBase,b.Element.missingglyph=function(a){this.base=b.Element.path,this.base(a),this.horizAdvX=0},b.Element.missingglyph.prototype=new b.Element.path,b.Element.glyph=function(a){this.base=b.Element.path,this.base(a),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},b.Element.glyph.prototype=new b.Element.path,b.Element.text=function(a){this.captureTextNodes=!0,this.base=b.Element.RenderedElementBase,this.base(a),this.baseSetContext=this.setContext,this.setContext=function(a){this.baseSetContext(a),this.style("dominant-baseline").hasValue()&&(a.textBaseline=this.style("dominant-baseline").value),this.style("alignment-baseline").hasValue()&&(a.textBaseline=this.style("alignment-baseline").value)},this.renderChildren=function(b){this.textAnchor=this.style("text-anchor").valueOrDefault("start"),this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y");for(var a=0;a<this.children.length;a++)this.renderChild(b,this,a)},this.renderChild=function(c,h,b){var a=h.children[b];a.attribute("x").hasValue()?a.x=a.attribute("x").toPixels("x"):(this.attribute("dx").hasValue()&&(this.y+=this.attribute("dx").toPixels("x")),a.attribute("dx").hasValue()&&(this.x+=a.attribute("dx").toPixels("x")),a.x=this.x);var f=a.measureText(c);if("start"!=this.textAnchor&&(0==b||a.attribute("x").hasValue())){for(var d=f,e=b+1;e<this.children.length;e++){var g=this.children[e];if(g.attribute("x").hasValue())break;d+=g.measureText(c)}a.x-="end"==this.textAnchor?d:d/2}this.x=a.x+f,a.attribute("y").hasValue()?a.y=a.attribute("y").toPixels("y"):(this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),a.attribute("dy").hasValue()&&(this.y+=a.attribute("dy").toPixels("y")),a.y=this.y),this.y=a.y,a.render(c);for(var b=0;b<a.children.length;b++)this.renderChild(c,a,b)}},b.Element.text.prototype=new b.Element.RenderedElementBase,b.Element.TextElementBase=function(a){this.base=b.Element.RenderedElementBase,this.base(a),this.getGlyph=function(c,b,a){var e=b[a],d=null;if(c.isArabic){var f="isolated";(0==a||" "==b[a-1])&&a<b.length-2&&" "!=b[a+1]&&(f="terminal"),a>0&&" "!=b[a-1]&&a<b.length-2&&" "!=b[a+1]&&(f="medial"),a>0&&" "!=b[a-1]&&(a==b.length-1||" "==b[a+1])&&(f="initial"),"undefined"!=typeof c.glyphs[e]&&(d=c.glyphs[e][f],null==d&&"glyph"==c.glyphs[e].type&&(d=c.glyphs[e]))}else d=c.glyphs[e];return null==d&&(d=c.missingGlyph),d},this.renderChildren=function(a){var c=this.parent.style("font-family").getDefinition();if(null==c)""!=a.fillStyle&&a.fillText(b.compressSpaces(this.getText()),this.x,this.y),""!=a.strokeStyle&&a.strokeText(b.compressSpaces(this.getText()),this.x,this.y);else{var g=this.parent.style("font-size").numValueOrDefault(b.Font.Parse(b.ctx.font).fontSize),i=this.parent.style("font-style").valueOrDefault(b.Font.Parse(b.ctx.font).fontStyle),e=this.getText();c.isRTL&&(e=e.split("").reverse().join(""));for(var h=b.ToNumberArray(this.parent.attribute("dx").value),d=0;d<e.length;d++){var j=this.getGlyph(c,e,d),f=g/c.fontFace.unitsPerEm;a.translate(this.x,this.y),a.scale(f,-f);var k=a.lineWidth;a.lineWidth=a.lineWidth*c.fontFace.unitsPerEm/g,"italic"==i&&a.transform(1,0,.4,1,0,0),j.render(a),"italic"==i&&a.transform(1,0,-.4,1,0,0),a.lineWidth=k,a.scale(1/f,-1/f),a.translate(-this.x,-this.y),this.x+=g*(j.horizAdvX||c.horizAdvX)/c.fontFace.unitsPerEm,"undefined"==typeof h[d]||isNaN(h[d])||(this.x+=h[d])}}},this.getText=function(){},this.measureText=function(c){var d=this.parent.style("font-family").getDefinition();if(null!=d){var i=this.parent.style("font-size").numValueOrDefault(b.Font.Parse(b.ctx.font).fontSize),f=0,e=this.getText();d.isRTL&&(e=e.split("").reverse().join(""));for(var g=b.ToNumberArray(this.parent.attribute("dx").value),a=0;a<e.length;a++){var j=this.getGlyph(d,e,a);f+=(j.horizAdvX||d.horizAdvX)*i/d.fontFace.unitsPerEm,"undefined"==typeof g[a]||isNaN(g[a])||(f+=g[a])}return f}var h=b.compressSpaces(this.getText());if(!c.measureText)return 10*h.length;c.save(),this.setContext(c);var k=c.measureText(h).width;return c.restore(),k}},b.Element.TextElementBase.prototype=new b.Element.RenderedElementBase,b.Element.tspan=function(a){this.captureTextNodes=!0,this.base=b.Element.TextElementBase,this.base(a),this.text=a.nodeValue||a.text||"",this.getText=function(){return this.text}},b.Element.tspan.prototype=new b.Element.TextElementBase,b.Element.tref=function(a){this.base=b.Element.TextElementBase,this.base(a),this.getText=function(){var a=this.attribute("xlink:href").getDefinition();return null!=a?a.children[0].getText():void 0}},b.Element.tref.prototype=new b.Element.TextElementBase,b.Element.a=function(a){this.base=b.Element.TextElementBase,this.base(a),this.hasText=!0;for(var c=0;c<a.childNodes.length;c++)3!=a.childNodes[c].nodeType&&(this.hasText=!1);this.text=this.hasText?a.childNodes[0].nodeValue:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(a){if(this.hasText){this.baseRenderChildren(a);var d=new b.Property("fontSize",b.Font.Parse(b.ctx.font).fontSize);b.Mouse.checkBoundingBox(this,new b.BoundingBox(this.x,this.y-d.toPixels("y"),this.x+this.measureText(a),this.y))}else{var c=new b.Element.g;c.children=this.children,c.parent=this,c.render(a)}},this.onclick=function(){window.open(this.attribute("xlink:href").value)},this.onmousemove=function(){b.ctx.canvas.style.cursor="pointer"}},b.Element.a.prototype=new b.Element.TextElementBase,b.Element.image=function(e){this.base=b.Element.RenderedElementBase,this.base(e);var a=this.attribute("xlink:href").value,c=a.match(/\.svg$/);if(b.Images.push(this),this.loaded=!1,c)this.img=b.ajax(a),this.loaded=!0;else{this.img=document.createElement("img");var d=this;this.img.onload=function(){d.loaded=!0},this.img.onerror=function(){console&&console.log('ERROR: image "'+a+'" not found'),d.loaded=!0},this.img.src=a}this.renderChildren=function(a){var f=this.attribute("x").toPixels("x"),g=this.attribute("y").toPixels("y"),d=this.attribute("width").toPixels("x"),e=this.attribute("height").toPixels("y");0!=d&&0!=e&&(a.save(),c?a.drawSvg(this.img,f,g,d,e):(a.translate(f,g),b.AspectRatio(a,this.attribute("preserveAspectRatio").value,d,this.img.width,e,this.img.height,0,0),a.drawImage(this.img,0,0)),a.restore())},this.getBoundingBox=function(){var a=this.attribute("x").toPixels("x"),c=this.attribute("y").toPixels("y"),d=this.attribute("width").toPixels("x"),e=this.attribute("height").toPixels("y");return new b.BoundingBox(a,c,a+d,c+e)}},b.Element.image.prototype=new b.Element.RenderedElementBase,b.Element.g=function(a){this.base=b.Element.RenderedElementBase,this.base(a),this.getBoundingBox=function(){for(var c=new b.BoundingBox,a=0;a<this.children.length;a++)c.addBoundingBox(this.children[a].getBoundingBox());return c}},b.Element.g.prototype=new b.Element.RenderedElementBase,b.Element.symbol=function(a){this.base=b.Element.RenderedElementBase,this.base(a),this.baseSetContext=this.setContext,this.setContext=function(c){if(this.baseSetContext(c),this.attribute("viewBox").hasValue()){var a=b.ToNumberArray(this.attribute("viewBox").value),d=a[0],e=a[1];width=a[2],height=a[3],b.AspectRatio(c,this.attribute("preserveAspectRatio").value,this.attribute("width").toPixels("x"),width,this.attribute("height").toPixels("y"),height,d,e),b.ViewPort.SetCurrent(a[2],a[3])}}},b.Element.symbol.prototype=new b.Element.RenderedElementBase,b.Element.style=function(o){this.base=b.Element.ElementBase,this.base(o);for(var d="",a=0;a<o.childNodes.length;a++)d+=o.childNodes[a].nodeValue;d=d.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,""),d=b.compressSpaces(d);for(var k=d.split("}"),a=0;a<k.length;a++)if(""!=b.trim(k[a]))for(var t=k[a].split("{"),r=t[0].split(","),f=t[1].split(";"),p=0;p<r.length;p++){var j=b.trim(r[p]);if(""!=j){for(var h={},c=0;c<f.length;c++){var m=f[c].indexOf(":"),i=f[c].substr(0,m),q=f[c].substr(m+1,f[c].length-m);null!=i&&null!=q&&(h[b.trim(i)]=new b.Property(b.trim(i),b.trim(q)))}if(b.Styles[j]=h,"@font-face"==j)for(var u=h["font-family"].value.replace(/"/g,""),g=h.src.value.split(","),e=0;e<g.length;e++)if(g[e].indexOf('format("svg")')>0)for(var n=g[e].indexOf("url"),v=g[e].indexOf(")",n),w=g[e].substr(n+5,v-n-6),x=b.parseXml(b.ajax(w)),s=x.getElementsByTagName("font"),l=0;l<s.length;l++){var y=b.CreateElement(s[l]);b.Definitions[u]=y}}}},b.Element.style.prototype=new b.Element.ElementBase,b.Element.use=function(a){this.base=b.Element.RenderedElementBase,this.base(a),this.baseSetContext=this.setContext,this.setContext=function(a){this.baseSetContext(a),this.attribute("x").hasValue()&&a.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&a.translate(0,this.attribute("y").toPixels("y"))},this.getDefinition=function(){var a=this.attribute("xlink:href").getDefinition();return this.attribute("width").hasValue()&&(a.attribute("width",!0).value=this.attribute("width").value),this.attribute("height").hasValue()&&(a.attribute("height",!0).value=this.attribute("height").value),a},this.path=function(b){var a=this.getDefinition();null!=a&&a.path(b)},this.renderChildren=function(b){var a=this.getDefinition();if(null!=a){var c=a.parent;a.parent=null,a.render(b),a.parent=c}}},b.Element.use.prototype=new b.Element.RenderedElementBase,b.Element.mask=function(a){this.base=b.Element.ElementBase,this.base(a),this.apply=function(j,f){var c=this.attribute("x").toPixels("x"),d=this.attribute("y").toPixels("y"),e=this.attribute("width").toPixels("x"),b=this.attribute("height").toPixels("y"),k=f.attribute("mask").value;f.attribute("mask").value="";var h=document.createElement("canvas");h.width=c+e,h.height=d+b;var i=h.getContext("2d");this.renderChildren(i);var g=document.createElement("canvas");g.width=c+e,g.height=d+b;var a=g.getContext("2d");f.render(a),a.globalCompositeOperation="destination-in",a.fillStyle=i.createPattern(h,"no-repeat"),a.fillRect(0,0,c+e,d+b),j.fillStyle=a.createPattern(g,"no-repeat"),j.fillRect(0,0,c+e,d+b),f.attribute("mask").value=k},this.render=function(){}},b.Element.mask.prototype=new b.Element.ElementBase,b.Element.clipPath=function(a){this.base=b.Element.ElementBase,this.base(a),this.apply=function(b){for(var a=0;a<this.children.length;a++)this.children[a].path&&(this.children[a].path(b),b.clip())},this.render=function(){}},b.Element.clipPath.prototype=new b.Element.ElementBase,b.Element.filter=function(a){this.base=b.Element.ElementBase,this.base(a),this.apply=function(m,a){var h=a.getBoundingBox(),f=this.attribute("x").toPixels("x"),g=this.attribute("y").toPixels("y");("image"==a.type||0==f||0==g)&&(f=h.x1,g=h.y1);var b=this.attribute("width").toPixels("x"),c=this.attribute("height").toPixels("y");("image"==a.type||0==b||0==c)&&(b=h.width(),c=h.height());var n=a.style("filter").value;a.style("filter").value="";var l="image"==a.type?0:.2,d=l*b,e=l*c,i=document.createElement("canvas");i.width=b+2*d,i.height=c+2*e;var k=i.getContext("2d");k.translate(-f+d,-g+e),a.render(k);for(var j=0;j<this.children.length;j++)this.children[j].apply(k,0,0,b+2*d,c+2*e);m.drawImage(i,0,0,b+2*d,c+2*e,f-d,g-e,b+2*d,c+2*e),a.style("filter",!0).value=n},this.render=function(){}},b.Element.filter.prototype=new b.Element.ElementBase,b.Element.feColorMatrix=function(d){function a(a,b,c,d,f,e){return a[4*c*d+4*b+e]}function c(a,b,c,d,g,e,f){a[4*c*d+4*b+e]=f}this.base=b.Element.ElementBase,this.base(d),this.apply=function(h,e,f,b,d){for(var g=h.getImageData(0,0,b,d),f=0;d>f;f++)for(var e=0;b>e;e++){var j=a(g.data,e,f,b,d,0),k=a(g.data,e,f,b,d,1),l=a(g.data,e,f,b,d,2),i=(j+k+l)/3;c(g.data,e,f,b,d,0,i),c(g.data,e,f,b,d,1,i),c(g.data,e,f,b,d,2,i)}h.clearRect(0,0,b,d),h.putImageData(g,0,0)}},b.Element.filter.prototype=new b.Element.feColorMatrix,b.Element.feGaussianBlur=function(d){function e(a){a=Math.max(a,.01);var c=Math.ceil(4*a)+1;mask=[];for(var b=0;c>b;b++)mask[b]=Math.exp(-.5*(b/a)*(b/a));return mask}function f(a){for(var c=0,b=1;b<a.length;b++)c+=Math.abs(a[b]);c=2*c+Math.abs(a[0]);for(var b=0;b<a.length;b++)a[b]/=c;return a}function c(i,o,k,b,f){for(var d=0;f>d;d++)for(var c=0;b>c;c++)for(var j=a(i,c,d,b,f,3)/255,e=0;4>e;e++){for(var n=k[0]*(0==j?255:a(i,c,d,b,f,e))*(0==j||3==e?1:j),h=1;h<k.length;h++){var l=a(i,Math.max(c-h,0),d,b,f,3)/255,m=a(i,Math.min(c+h,b-1),d,b,f,3)/255;n+=k[h]*((0==l?255:a(i,Math.max(c-h,0),d,b,f,e))*(0==l||3==e?1:l)+(0==m?255:a(i,Math.min(c+h,b-1),d,b,f,e))*(0==m||3==e?1:m))}g(o,d,c,f,b,e,n)}}function a(a,b,c,d,f,e){return a[4*c*d+4*b+e]}function g(a,b,c,d,g,e,f){a[4*c*d+4*b+e]=f}function h(g,a,b,i){var h=g.getImageData(0,0,a,b),d=e(i);d=f(d),tmp=[],c(h.data,tmp,d,a,b),c(tmp,h.data,d,b,a),g.clearRect(0,0,a,b),g.putImageData(h,0,0)}this.base=b.Element.ElementBase,this.base(d),this.apply=function(a,d,e,b,c){h(a,b,c,this.attribute("stdDeviation").numValue())}},b.Element.filter.prototype=new b.Element.feGaussianBlur,b.Element.title=function(){},b.Element.title.prototype=new b.Element.ElementBase,b.Element.desc=function(){},b.Element.desc.prototype=new b.Element.ElementBase,b.Element.MISSING=function(a){console&&console.log("ERROR: Element '"+a.nodeName+"' not yet implemented.")},b.Element.MISSING.prototype=new b.Element.ElementBase,b.CreateElement=function(a){var c=a.nodeName.replace(/^[^:]+:/,"");c=c.replace(/\-/g,"");var d=null;return d="undefined"!=typeof b.Element[c]?new b.Element[c](a):new b.Element.MISSING(a),d.type=a.nodeName,d},b.load=function(a,c){b.loadXml(a,b.ajax(c))},b.loadXml=function(a,c){b.loadXmlDoc(a,b.parseXml(c))},b.loadXmlDoc=function(c,h){b.init(c);var e=function(a){for(var b=c.canvas;b;)a.x-=b.offsetLeft,a.y-=b.offsetTop,b=b.offsetParent;return window.scrollX&&(a.x+=window.scrollX),window.scrollY&&(a.y+=window.scrollY),a};1!=b.opts.ignoreMouse&&(c.canvas.onclick=function(a){var c=e(new b.Point(null!=a?a.clientX:event.clientX,null!=a?a.clientY:event.clientY));b.Mouse.onclick(c.x,c.y)},c.canvas.onmousemove=function(a){var c=e(new b.Point(null!=a?a.clientX:event.clientX,null!=a?a.clientY:event.clientY));b.Mouse.onmousemove(c.x,c.y)});var a=b.CreateElement(h.documentElement);a.root=!0;var f=!0,g=function(){b.ViewPort.Clear(),c.canvas.parentNode&&b.ViewPort.SetCurrent(c.canvas.parentNode.clientWidth,c.canvas.parentNode.clientHeight),1!=b.opts.ignoreDimensions&&(a.style("width").hasValue()&&(c.canvas.width=a.style("width").toPixels("x"),c.canvas.style.width=c.canvas.width+"px"),a.style("height").hasValue()&&(c.canvas.height=a.style("height").toPixels("y"),c.canvas.style.height=c.canvas.height+"px"));var d=c.canvas.clientWidth||c.canvas.width,e=c.canvas.clientHeight||c.canvas.height;if(1==b.opts.ignoreDimensions&&a.style("width").hasValue()&&a.style("height").hasValue()&&(d=a.style("width").toPixels("x"),e=a.style("height").toPixels("y")),b.ViewPort.SetCurrent(d,e),null!=b.opts.offsetX&&(a.attribute("x",!0).value=b.opts.offsetX),null!=b.opts.offsetY&&(a.attribute("y",!0).value=b.opts.offsetY),null!=b.opts.scaleWidth&&null!=b.opts.scaleHeight){var h=1,i=1,g=b.ToNumberArray(a.attribute("viewBox").value);a.attribute("width").hasValue()?h=a.attribute("width").toPixels("x")/b.opts.scaleWidth:isNaN(g[2])||(h=g[2]/b.opts.scaleWidth),a.attribute("height").hasValue()?i=a.attribute("height").toPixels("y")/b.opts.scaleHeight:isNaN(g[3])||(i=g[3]/b.opts.scaleHeight),a.attribute("width",!0).value=b.opts.scaleWidth,a.attribute("height",!0).value=b.opts.scaleHeight,a.attribute("viewBox",!0).value="0 0 "+d*h+" "+e*i,a.attribute("preserveAspectRatio",!0).value="none"}1!=b.opts.ignoreClear&&c.clearRect(0,0,d,e),a.render(c),f&&(f=!1,"function"==typeof b.opts.renderCallback&&b.opts.renderCallback())},d=!0;b.ImagesLoaded()&&(d=!1,g()),b.intervalID=setInterval(function(){var a=!1;if(d&&b.ImagesLoaded()&&(d=!1,a=!0),1!=b.opts.ignoreMouse&&(a|=b.Mouse.hasEvents()),1!=b.opts.ignoreAnimation)for(var c=0;c<b.Animations.length;c++)a|=b.Animations[c].update(1e3/b.FRAMERATE);"function"==typeof b.opts.forceRedraw&&1==b.opts.forceRedraw()&&(a=!0),a&&(g(),b.Mouse.runEvents())},1e3/b.FRAMERATE)},b.stop=function(){b.intervalID&&clearInterval(b.intervalID)},b.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(a,b){this.events.push({type:"onclick",x:a,y:b,run:function(a){a.onclick&&a.onclick()}})},this.onmousemove=function(a,b){this.events.push({type:"onmousemove",x:a,y:b,run:function(a){a.onmousemove&&a.onmousemove()}})},this.eventElements=[],this.checkPath=function(d,b){for(var a=0;a<this.events.length;a++){var c=this.events[a];b.isPointInPath&&b.isPointInPath(c.x,c.y)&&(this.eventElements[a]=d)}},this.checkBoundingBox=function(c,d){for(var a=0;a<this.events.length;a++){var b=this.events[a];d.isPointInBox(b.x,b.y)&&(this.eventElements[a]=c)}},this.runEvents=function(){b.ctx.canvas.style.cursor="";for(var a=0;a<this.events.length;a++)for(var d=this.events[a],c=this.eventElements[a];c;)d.run(c),c=c.parent;this.events=[],this.eventElements=[]}},b}this.canvg=function(a,d,f){if(null!=a||null!=d||null!=f){f=f||{},"string"==typeof a&&(a=document.getElementById(a)),null!=a.svg&&a.svg.stop();var e=b();(1!=a.childNodes.length||"OBJECT"!=a.childNodes[0].nodeName)&&(a.svg=e),e.opts=f;var h=a.getContext("2d");"undefined"!=typeof d.documentElement?e.loadXmlDoc(h,d):"<"==d.substr(0,1)?e.loadXml(h,d):e.load(h,d)}else for(var j=document.getElementsByTagName("svg"),i=0;i<j.length;i++){var c=j[i],g=document.createElement("canvas");g.width=c.clientWidth,g.height=c.clientHeight,c.parentNode.insertBefore(g,c),c.parentNode.removeChild(c);var k=document.createElement("div");k.appendChild(c),canvg(g,k.innerHTML)}}}(),window.CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(a,b,c,d,e){canvg(this.canvas,a,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:b,offsetY:c,scaleWidth:d,scaleHeight:e})}),function(z,y){var a,w,s,v,x,c,h,n,j,t,o,d,b,m,e,k,p,q,u,r,g,i,l,f;a=function(b){return new a.prototype.init(b)},"undefined"!=typeof require&&"undefined"!=typeof exports&&"undefined"!=typeof module?module.exports=a:z.Globalize=a,a.cultures={},a.prototype={constructor:a,init:function(b){return this.cultures=a.cultures,this.cultureSelector=b,this}},a.prototype.init.prototype=a.prototype,a.cultures["default"]={name:"en",englishName:"English",nativeName:"English",isRTL:!1,language:"en",numberFormat:{pattern:["-n"],decimals:2,",":",",".":".",groupSizes:[3],"+":"+","-":"-",NaN:"NaN",negativeInfinity:"-Infinity",positiveInfinity:"Infinity",percent:{pattern:["-n %","n %"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"%"},currency:{pattern:["($n)","$n"],decimals:2,groupSizes:[3],",":",",".":".",symbol:"$"}},calendars:{standard:{name:"Gregorian_USEnglish","/":"/",":":":",firstDay:0,days:{names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],namesShort:["Su","Mo","Tu","We","Th","Fr","Sa"]},months:{names:["January","February","March","April","May","June","July","August","September","October","November","December",""],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""]},AM:["AM","am","AM"],PM:["PM","pm","PM"],eras:[{name:"A.D.",start:null,offset:0}],twoDigitYearMax:2029,patterns:{d:"M/d/yyyy",D:"dddd, MMMM dd, yyyy",t:"h:mm tt",T:"h:mm:ss tt",f:"dddd, MMMM dd, yyyy h:mm tt",F:"dddd, MMMM dd, yyyy h:mm:ss tt",M:"MMMM dd",Y:"yyyy MMMM",S:"yyyy'-'MM'-'dd'T'HH':'mm':'ss"}}},messages:{}},a.cultures["default"].calendar=a.cultures["default"].calendars.standard,a.cultures.en=a.cultures["default"],a.cultureSelector="en",w=/^0x[a-f0-9]+$/i,s=/^[+\-]?infinity$/i,v=/^[+\-]?\d*\.?\d*(e[+\-]?\d+)?$/,x=/^\s+|\s+$/g,c=function(a,c){if(a.indexOf)return a.indexOf(c);for(var b=0,d=a.length;d>b;b++)if(a[b]===c)return b;return-1},h=function(a,b){return a.substr(a.length-b.length)===b},n=function(){var f,d,c,b,g,h,a=arguments[0]||{},e=1,k=arguments.length,i=!1;for("boolean"==typeof a&&(i=a,a=arguments[1]||{},e=2),"object"==typeof a||t(a)||(a={});k>e;e++)if(null!=(f=arguments[e]))for(d in f)c=a[d],b=f[d],a!==b&&(i&&b&&(o(b)||(g=j(b)))?(g?(g=!1,h=c&&j(c)?c:[]):h=c&&o(c)?c:{},a[d]=n(i,h,b)):b!==y&&(a[d]=b));return a},j=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},t=function(a){return"[object Function]"===Object.prototype.toString.call(a)},o=function(a){return"[object Object]"===Object.prototype.toString.call(a)},d=function(a,b){return 0===a.indexOf(b)},b=function(a){return(a+"").replace(x,"")},m=function(a){return isNaN(a)?0/0:Math[0>a?"ceil":"floor"](a)},e=function(a,c,d){var b;for(b=a.length;c>b;b+=1)a=d?"0"+a:a+"0";return a},k=function(d,b){for(var e=0,a=!1,c=0,g=d.length;g>c;c++){var f=d.charAt(c);switch(f){case"'":a?b.push("'"):e++,a=!1;break;case"\\":a&&b.push("\\"),a=!a;break;default:b.push(f),a=!1}}return e},p=function(d,a){a=a||"F";var b,e=d.patterns,c=a.length;if(1===c){if(b=e[a],!b)throw"Invalid date format string '"+a+"'.";a=b}else 2===c&&"%"===a.charAt(0)&&(a=a.charAt(1));return a},q=function(b,f,o){function e(d,a){var b,c=d+"";return a>1&&c.length<a?(b=C[a-2]+c,b.substr(b.length-a,a)):b=c}function B(){return l||v?l:(l=E.test(f),v=!0,l)}function t(a,b){if(n)return n[b];switch(b){case 0:return a.getFullYear();case 1:return a.getMonth();case 2:return a.getDate();default:throw"Invalid part value "+b}}var a,c=o.calendar,s=c.convert;if(!f||!f.length||"i"===f){if(o&&o.name.length)if(s)a=q(b,c.patterns.F,o);else{var w=new Date(b.getTime()),F=g(b,c.eras);w.setFullYear(i(b,c,F)),a=w.toLocaleString()}else a=b.toString();return a}var A=c.eras,z="s"===f;f=p(c,f),a=[];var h,l,v,n,C=["0","00","000"],E=/([^d]|^)(d|dd)([^d]|$)/g,x=0,y=r();for(!z&&s&&(n=s.fromGregorian(b));;){var H=y.lastIndex,m=y.exec(f),D=f.slice(H,m?m.index:f.length);if(x+=k(D,a),!m)break;if(x%2)a.push(m[0]);else{var u=m[0],d=u.length;switch(u){case"ddd":case"dddd":var G=3===d?c.days.namesAbbr:c.days.names;a.push(G[b.getDay()]);break;case"d":case"dd":l=!0,a.push(e(t(b,2),d));break;case"MMM":case"MMMM":var j=t(b,1);a.push(c.monthsGenitive&&B()?c.monthsGenitive[3===d?"namesAbbr":"names"][j]:c.months[3===d?"namesAbbr":"names"][j]);
break;case"M":case"MM":a.push(e(t(b,1)+1,d));break;case"y":case"yy":case"yyyy":j=n?n[0]:i(b,c,g(b,A),z),4>d&&(j%=100),a.push(e(j,d));break;case"h":case"hh":h=b.getHours()%12,0===h&&(h=12),a.push(e(h,d));break;case"H":case"HH":a.push(e(b.getHours(),d));break;case"m":case"mm":a.push(e(b.getMinutes(),d));break;case"s":case"ss":a.push(e(b.getSeconds(),d));break;case"t":case"tt":j=b.getHours()<12?c.AM?c.AM[0]:" ":c.PM?c.PM[0]:" ",a.push(1===d?j.charAt(0):j);break;case"f":case"ff":case"fff":a.push(e(b.getMilliseconds(),3).substr(0,d));break;case"z":case"zz":h=b.getTimezoneOffset()/60,a.push((0>=h?"+":"-")+e(Math.floor(Math.abs(h)),d));break;case"zzz":h=b.getTimezoneOffset()/60,a.push((0>=h?"+":"-")+e(Math.floor(Math.abs(h)),2)+":"+e(Math.abs(b.getTimezoneOffset()%60),2));break;case"g":case"gg":c.eras&&a.push(c.eras[g(b,A)].name);break;case"/":a.push(c["/"]);break;default:throw"Invalid date format pattern '"+u+"'."}}}return a.join("")},function(){var a;a=function(j,i,m){var l=m.groupSizes,h=l[0],k=1,p=Math.pow(10,i),o=Math.round(j*p)/p;isFinite(o)||(o=j),j=o;var b=j+"",a="",f=b.split(/e/i),c=f.length>1?parseInt(f[1],10):0;b=f[0],f=b.split("."),b=f[0],a=f.length>1?f[1]:"",c>0?(a=e(a,c,!1),b+=a.slice(0,c),a=a.substr(c)):0>c&&(c=-c,b=e(b,c+1,!0),a=b.slice(-c,b.length)+a,b=b.slice(0,-c)),a=i>0?m["."]+(a.length>i?a.slice(0,i):e(a,i)):"";for(var d=b.length-1,n=m[","],g="";d>=0;){if(0===h||h>d)return b.slice(0,d+1)+(g.length?n+g+a:a);g=b.slice(d-h+1,d+1)+(g.length?n+g:""),d-=h,k<l.length&&(h=l[k],k++)}return b.slice(0,d+1)+n+g+a},u=function(d,f,k){if(!isFinite(d))return 1/0===d?k.numberFormat.positiveInfinity:d===-1/0?k.numberFormat.negativeInfinity:k.numberFormat.NaN;if(!f||"i"===f)return k.name.length?d.toLocaleString():d.toString();f=f||"D";var j,g=k.numberFormat,b=Math.abs(d),i=-1;f.length>1&&(i=parseInt(f.slice(1),10));var c,n=f.charAt(0).toUpperCase();switch(n){case"D":j="n",b=m(b),-1!==i&&(b=e(""+b,i,!0)),0>d&&(b="-"+b);break;case"N":c=g;case"C":c=c||g.currency;case"P":c=c||g.percent,j=0>d?c.pattern[0]:c.pattern[1]||"n",-1===i&&(i=c.decimals),b=a(b*("P"===n?100:1),i,c);break;default:throw"Bad number format specifier: "+n}for(var o=/n|\$|-|%/g,h="";;){var p=o.lastIndex,l=o.exec(j);if(h+=j.slice(p,l?l.index:j.length),!l)break;switch(l[0]){case"n":h+=b;break;case"$":h+=g.currency.symbol;break;case"-":/[1-9]/.test(b)&&(h+=g["-"]);break;case"%":h+=g.percent.symbol}}return h}}(),r=function(){return/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|gg|g/g},g=function(d,b){if(!b)return 0;for(var c,e=d.getTime(),a=0,f=b.length;f>a;a++)if(c=b[a].start,null===c||e>=c)return a;return 0},i=function(c,a,d,e){var b=c.getFullYear();return!e&&a.eras&&(b-=a.eras[d].offset),b},function(){var h,j,m,n,a,f,e;h=function(c,a){if(100>a){var d=new Date,f=g(d),e=i(d,c,f),b=c.twoDigitYearMax;b="string"==typeof b?(new Date).getFullYear()%100+parseInt(b,10):b,a+=e-e%100,a>b&&(a-=100)}return a},j=function(g,a,i){var b,h=g.days,d=g._upperDays;return d||(g._upperDays=d=[e(h.names),e(h.namesAbbr),e(h.namesShort)]),a=f(a),i?(b=c(d[1],a),-1===b&&(b=c(d[2],a))):b=c(d[0],a),b},m=function(a,b,i){var j=a.months,k=a.monthsGenitive||a.months,d=a._upperMonths,g=a._upperMonthsGen;d||(a._upperMonths=d=[e(j.names),e(j.namesAbbr)],a._upperMonthsGen=g=[e(k.names),e(k.namesAbbr)]),b=f(b);var h=c(i?d[1]:d[0],b);return 0>h&&(h=c(i?g[1]:g[0],b)),h},n=function(h,i){var d=h._parseRegExp;if(d){var n=d[i];if(n)return n}else h._parseRegExp=d={};for(var c,f=p(h,i).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1"),b=["^"],m=[],e=0,j=0,l=r();null!==(c=l.exec(f));){var o=f.slice(e,c.index);if(e=l.lastIndex,j+=k(o,b),j%2)b.push(c[0]);else{var a,g=c[0],q=g.length;switch(g){case"dddd":case"ddd":case"MMMM":case"MMM":case"gg":case"g":a="(\\D+)";break;case"tt":case"t":a="(\\D*)";break;case"yyyy":case"fff":case"ff":case"f":a="(\\d{"+q+"})";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":a="(\\d\\d?)";break;case"zzz":a="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":a="([+-]?\\d\\d?)";break;case"/":a="(\\/)";break;default:throw"Invalid date format pattern '"+g+"'."}a&&b.push(a),m.push(c[0])}}k(f.slice(e),b),b.push("$");var s=b.join("").replace(/\s+/g,"\\s+"),t={regExp:s,groups:m};return d[i]=t},a=function(a,b,c){return b>a||a>c},f=function(a){return a.split("").join(" ").toUpperCase()},e=function(b){for(var c=[],a=0,d=b.length;d>a;a++)c[a]=f(b[a]);return c},l=function(C,M,O){C=b(C);var c=O.calendar,J=n(c,M),H=new RegExp(J.regExp).exec(C);if(null===H)return null;for(var p,G=J.groups,A=null,l=null,k=null,o=null,r=null,i=0,D=0,E=0,x=0,q=null,z=!1,t=0,L=G.length;L>t;t++){var f=H[t+1];if(f){var F=G[t],w=F.length,g=parseInt(f,10);switch(F){case"dd":case"d":if(o=g,a(o,1,31))return null;break;case"MMM":case"MMMM":if(k=m(c,f,3===w),a(k,0,11))return null;break;case"M":case"MM":if(k=g-1,a(k,0,11))return null;break;case"y":case"yy":case"yyyy":if(l=4>w?h(c,g):g,a(l,0,9999))return null;break;case"h":case"hh":if(i=g,12===i&&(i=0),a(i,0,11))return null;break;case"H":case"HH":if(i=g,a(i,0,23))return null;break;case"m":case"mm":if(D=g,a(D,0,59))return null;break;case"s":case"ss":if(E=g,a(E,0,59))return null;break;case"tt":case"t":if(z=c.PM&&(f===c.PM[0]||f===c.PM[1]||f===c.PM[2]),!z&&(!c.AM||f!==c.AM[0]&&f!==c.AM[1]&&f!==c.AM[2]))return null;break;case"f":case"ff":case"fff":if(x=g*Math.pow(10,3-w),a(x,0,999))return null;break;case"ddd":case"dddd":if(r=j(c,f,3===w),a(r,0,6))return null;break;case"zzz":var B=f.split(/:/);if(2!==B.length)return null;if(p=parseInt(B[0],10),a(p,-12,13))return null;var y=parseInt(B[1],10);if(a(y,0,59))return null;q=60*p+(d(f,"-")?-y:y);break;case"z":case"zz":if(p=g,a(p,-12,13))return null;q=60*p;break;case"g":case"gg":var s=f;if(!s||!c.eras)return null;s=b(s.toLowerCase());for(var u=0,N=c.eras.length;N>u;u++)if(s===c.eras[u].name.toLowerCase()){A=u;break}if(null===A)return null}}}var I,e=new Date,v=c.convert;if(I=v?v.fromGregorian(e)[0]:e.getFullYear(),null===l?l=I:c.eras&&(l+=c.eras[A||0].offset),null===k&&(k=0),null===o&&(o=1),v){if(e=v.toGregorian(l,k,o),null===e)return null}else{if(e.setFullYear(l,k,o),e.getDate()!==o)return null;if(null!==r&&e.getDay()!==r)return null}if(z&&12>i&&(i+=12),e.setHours(i,D,E,x),null!==q){var K=e.getMinutes()-(q+e.getTimezoneOffset());e.setHours(e.getHours()+parseInt(K/60,10),K%60)}return e}}(),f=function(a,f,g){var e,b=f["-"],c=f["+"];switch(g){case"n -":b=" "+b,c=" "+c;case"n-":h(a,b)?e=["-",a.substr(0,a.length-b.length)]:h(a,c)&&(e=["+",a.substr(0,a.length-c.length)]);break;case"- n":b+=" ",c+=" ";case"-n":d(a,b)?e=["-",a.substr(b.length)]:d(a,c)&&(e=["+",a.substr(c.length)]);break;case"(n)":d(a,"(")&&h(a,")")&&(e=["-",a.substr(1,a.length-2)])}return e||["",a]},a.prototype.findClosestCulture=function(b){return a.findClosestCulture.call(this,b)},a.prototype.format=function(b,c,d){return a.format.call(this,b,c,d)},a.prototype.localize=function(b,c){return a.localize.call(this,b,c)},a.prototype.parseInt=function(b,c,d){return a.parseInt.call(this,b,c,d)},a.prototype.parseFloat=function(b,c,d){return a.parseFloat.call(this,b,c,d)},a.prototype.culture=function(b){return a.culture.call(this,b)},a.addCultureInfo=function(a,c,d){var b={},e=!1;"string"!=typeof a?(d=a,a=this.culture().name,b=this.cultures[a]):"string"!=typeof c?(d=c,e=null==this.cultures[a],b=this.cultures[a]||this.cultures["default"]):(e=!0,b=this.cultures[c]),this.cultures[a]=n(!0,{},b,d),e&&(this.cultures[a].calendar=this.cultures[a].calendars.standard)},a.findClosestCulture=function(c){var f;if(!c)return this.findClosestCulture(this.cultureSelector)||this.cultures["default"];if("string"==typeof c&&(c=c.split(",")),j(c)){var d,a,h=this.cultures,l=c,i=l.length,g=[];for(a=0;i>a;a++){c=b(l[a]);var e,k=c.split(";");d=b(k[0]),1===k.length?e=1:(c=b(k[1]),0===c.indexOf("q=")?(c=c.substr(2),e=parseFloat(c),e=isNaN(e)?0:e):e=1),g.push({lang:d,pri:e})}for(g.sort(function(a,b){return a.pri<b.pri?1:a.pri>b.pri?-1:0}),a=0;i>a;a++)if(d=g[a].lang,f=h[d])return f;for(a=0;i>a;a++)for(d=g[a].lang;;){var m=d.lastIndexOf("-");if(-1===m)break;if(d=d.substr(0,m),f=h[d])return f}for(a=0;i>a;a++){d=g[a].lang;for(var o in h){var n=h[o];if(n.language==d)return n}}}else if("object"==typeof c)return c;return f||null},a.format=function(a,b,d){var c=this.findClosestCulture(d);return a instanceof Date?a=q(a,b,c):"number"==typeof a&&(a=u(a,b,c)),a},a.localize=function(a,b){return this.findClosestCulture(b).messages[a]||this.cultures["default"].messages[a]},a.parseDate=function(f,a,b){b=this.findClosestCulture(b);var c,g,d;if(a){if("string"==typeof a&&(a=[a]),a.length)for(var e=0,i=a.length;i>e;e++){var h=a[e];if(h&&(c=l(f,h,b)))break}}else{d=b.calendar.patterns;for(g in d)if(c=l(f,d[g],b))break}return c||null},a.parseInt=function(b,c,d){return m(a.parseFloat(b,c,d))},a.parseFloat=function(a,l,r){"number"!=typeof l&&(r=l,l=10);var e=this.findClosestCulture(r),k=0/0,b=e.numberFormat;if(a.indexOf(e.numberFormat.currency.symbol)>-1&&(a=a.replace(e.numberFormat.currency.symbol,""),a=a.replace(e.numberFormat.currency["."],e.numberFormat["."])),a.indexOf(e.numberFormat.percent.symbol)>-1&&(a=a.replace(e.numberFormat.percent.symbol,"")),a=a.replace(/ /g,""),s.test(a))k=parseFloat(a);else if(!l&&w.test(a))k=parseInt(a,16);else{var c=f(a,b,b.pattern[0]),h=c[0],g=c[1];""===h&&"(n)"!==b.pattern[0]&&(c=f(a,b,"(n)"),h=c[0],g=c[1]),""===h&&"-n"!==b.pattern[0]&&(c=f(a,b,"-n"),h=c[0],g=c[1]),h=h||"+";var n,i,j=g.indexOf("e");0>j&&(j=g.indexOf("E")),0>j?(i=g,n=null):(i=g.substr(0,j),n=g.substr(j+1));var d,m,x=b["."],p=i.indexOf(x);0>p?(d=i,m=null):(d=i.substr(0,p),m=i.substr(p+x.length));var q=b[","];d=d.split(q).join("");var t=q.replace(/\u00A0/g," ");q!==t&&(d=d.split(t).join(""));var o=h+d;if(null!==m&&(o+="."+m),null!==n){var u=f(n,b,"-n");o+="e"+(u[0]||"+")+u[1]}v.test(o)&&(k=parseFloat(o))}return k},a.culture=function(a){return"undefined"!=typeof a&&(this.cultureSelector=a),this.findClosestCulture(a)||this.cultures["default"]}}(this),function(c,k,d){function F(a){var b="";a=Math.abs(a);do{var c=a%26;b=String.fromCharCode(c+97)+b,a=(a-c)/26}while(a>0);return b}function D(){return"shield"+F(G++)}function A(){var b=b=[8,9,"a","b"],a=function(){return(0|65536*(1+Math.random())).toString(16).substring(1)};return a()+a()+"-"+a()+"-4"+a().substr(0,3)+"-"+b[Math.floor(4*Math.random())]+a().substr(0,3)+"-"+a()+a()+a()}function m(b){var c=/\{([\.\d\w\:\-\/\' ]+)\}/g,a=arguments,f=a&&a.length>1&&typeof a[1]===l,g=typeof Globalize===e&&typeof Globalize.format===e;return b.replace(c,function(m,b){var c,i,j=b.indexOf(":");if(j>0){var l=b;b=l.substring(0,j),i=l.substring(j+1)}if(f){var e=b.split(".");if(e.length>1||!/^\d+$/.test(e)){for(var h=a[1],k=0;k<e.length&&h!==d;k++)h=h[e[k]];c=h}else c=a[parseInt(b,10)+1]}else c=a[parseInt(b,10)+1];return i&&g&&(c=Globalize.format(c,i)),c})}function b(a){var b=Object.prototype.toString.call(a);return null===a?"null":a===d?"undefined":b.substr(8,b.length-9).toLowerCase()}function u(h){var l,i,g,j,b,k=Array.apply(null,arguments),m=a.array(h)&&h.length&&!p(h,function(b){return!a.func(b)}).length,e=k[1];if(!m)return f.apply(c,k);for(a.object(e)||a.array(e)||(e={}),i=2;i<k.length;i++)if(l=k[i])for(g in l)b=l[g],j=e[g],b&&p(h,function(a){return b instanceof a}).length?e[g]=b:a.object(b)||a.array(b)?(a.object(j)||(j=e[g]=a.array(b)?[]:{}),e[g]=u(h,j,b)):a.date(b)?e[g]=new Date(b.getTime()):b!==d&&(e[g]=b);return e}function t(b){var a,c=[];for(a in b)b.hasOwnProperty(a)&&c.push(a);return c}function B(i,e){var d,j,g,c,k,b,h,f=y[e];if(!a.string(e))throw new Error("shield.get: parameter 'path' must be a string.");if(f)return f(i);for(d=e.split("."),c=0,k=d.length;k>c;c++)b=d[c],g=b.indexOf("["),b&&(0>g?(h=b.indexOf("'")<0?"'":'"',b=d[c]="["+h+b+h+"]"):g>0&&(b=d[c]="."+b));j=d.join("");try{f=new Function("a","try{return a"+j+"}catch(e){return arguments[1];}")}catch(l){throw new Error("shield.get: invalid 'path' parameter")}return(y[e]=f)(i)}function C(a,b){s.ui[a]=b,c.fn["shield"+a]=function(f){var g,h=this;return typeof f===n?(g=[].slice.call(arguments,1),this.each(function(){var b,i,j=c.data(this,"shieldWidget");if(!j)throw new Error(m("shield: cannot call method '{0}' on uninitialized {1}.",f,a));if(b=j[f],typeof b!==e)throw new Error(m("shield: cannot find method '{0}' of {1}",f,a));return i=b.apply(j,g),i!==d?(h=i,!1):void 0}),h):this.each(function(){var a=new b(this,f);c(this).data("shieldWidget",a)})}}var s=k.shield=k.shield||{},f=c.extend,p=c.grep,l="object",n="string",e="function",o="array",j="number",q="date",v="boolean",w="null",x="undefined",G=100,z={},y={},i=function(){};i.extend=function(c){var g,h,a,i,e=this,j=function(){},d=c&&c.init?c.init:function(){e.apply(this,arguments)};j.prototype=e.prototype,g=d.fn=d.prototype=new j;for(var h in c)a=c[h],i=b(a),g[h]=a&&typeof a===l?f(!0,i===o?[]:{},e.prototype[h],a):a;return g.constructor=d,d.extend=e.extend,d},Date.prototype.toISOString||!function(){function a(b){var a=String(b);return 1===a.length&&(a="0"+a),a}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}(),c.fn.swidget=function(){var a=this.map(function(){return c(this).data("shieldWidget")}).get();return a.length?a.length>1?a:a[0]:null};var h=i.extend({init:function(a){var d=this,b=(a||{}).events;d.events={},a=a||{};for(var c in b)typeof b[c]===e&&d.on(c,b[c])},on:function(b,f,n){var c,i,e,m,j,k=this,l=k.events,d=g.array(b),h=a.func(f);if(a.object(b)){d=[];for(j in b)d.push(j);h=!1,f=b}for(e=0,m=d.length;m>e;e++)b=d[e],c=h?f:f[b],a.func(c)&&(n&&(i=c,c=function(b,c){var a=function(){k.off(b,a),c.apply(this,arguments)};return a}(b,i)),(l[b]||(l[b]=[])).push(c))},one:function(a,b){this.on(a,b,!0)},off:function(b,f){var c,i,e,d,j,m=this,k=m.events,h=g.array(b),l=a.func(f);if(a.object(b)){h=[];for(j in b)h.push(j);l=!1,f=b}for(e=0;e<h.length;e++){if(b=h[e],c=k[b]||[],i=l?f:(f||{})[b])for(d=c.length-1;d>=0;d--)c[d]===i&&c.splice(d,1);else c.length=0;c.length||delete k[b]}},trigger:function(e,f){var a,b,c=this,d=(c.events[e]||[]).slice();for(a=0,b=d.length;b>a;a++)d[a].apply(c,[].slice.call(arguments,1));return f},destroy:function(){this.events={}}}),r=i.extend({init:function(c){var a=!1,b=!1;f(this,{timeStamp:(new Date).getTime(),isDefaultPrevented:function(){return a},isPropagationStopped:function(){return b},preventDefault:function(){a=!0},stopPropagation:function(){b=!0}},c)}}),E=h.extend({init:function(e,b){var a=this,b=b||{},d=a.constructor;a.element=c(e),a.initialOptions=b,a.options=f(!0,{},d.defaults,(d.themes||{})[b.theme]),a.setOptions(b),h.fn.init.call(a,b)},setOptions:function(b){var a=this;return a.options=f(!0,a.options,b)},trigger:function(i,b,j){var d,g=this,b=a.event(b)?{domEvent:b}:b;return!b||!b.domEvent||b.domEvent instanceof c.Event||(b.domEvent=c.Event(b.domEvent)),d=new r(f({type:i,target:g},b)),h.fn.trigger.call(g,i,d),typeof j!==e||d.isDefaultPrevented()||j.call(g,d),d}}),a={string:function(a){return b(a)===n},number:function(a){return b(a)===j},integer:function(a){return b(a)===j&&/^[\+\-]?\d+$/.test(a+"")},"float":function(a){return b(a)===j&&/^[\+\-]?\d+\.\d+$/.test(a+"")},func:function(a){return b(a)===e},object:function(a){return b(a)===l},array:function(a){return b(a)===o},date:function(a){return b(a)===q},"boolean":function(a){return b(a)===v},"null":function(a){return b(a)===w},undefined:function(a){return b(a)===x},defined:function(a){return a!==d&&null!==a},event:function(a){return k.Event&&a instanceof k.Event||a&&a.altKey!==d}},g={"int":function(a,b){return parseInt(a,b||10)},"float":function(a){return parseFloat(a)},array:function(a){return a instanceof Array?a:a!==d?[a]:[]},string:function(a){return a+""},key:function(a){var i=b(a);switch(i){case w:case x:return i;case l:var k=t(a).sort(),d=[];return c.each(k,function(c,b){d.push(b+":"+g.key(a[b]))}),"{"+d.join(",")+"}";case o:var f,h,d="[";for(f=0,h=a.length;h>f;f++)d+=g.key(a[f]),h-1>f&&(d+=",");return d+="]";case q:return a.toISOString();case n:case j:case v:case e:default:return a+""}}};!function(){z.stableSort=function(){var a="abcdefghijklmnopqrstuvwxyz";return"xyzvwtursopqmnklhijfgdeabc"==a.split("").sort(function(b,c){return~~(a.indexOf(c)/2.3)-~~(a.indexOf(b)/2.3)}).join("")}()}(),f(s,{Class:i,Dispatcher:h,Event:r,format:m,strid:D,guid:A,support:z,extend:u,type:b,is:a,to:g,keys:t,get:B,ui:{Widget:E,plugin:C}})}(jQuery,function(){return this}());shield.version='1.3.2';